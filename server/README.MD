# âœ… knife4j æ–°æ³¨è§£

---

## å½“å‰ä¸»æµï¼šSwagger 3.0 + OpenAPI 3.0 æ³¨è§£ï¼ˆæ¨èç”¨äº Spring Boot 2.6+ / 3.xï¼‰

> å¯¹åº”ä¾èµ–ï¼š`knife4j-openapi3-jakarta-spring-boot-starter`

### ğŸ”¹ ç±»çº§åˆ«æ³¨è§£
| æ—§æ³¨è§£ (Swagger 2) | æ–°æ³¨è§£ (OpenAPI 3.0) | è¯´æ˜ |
|------------------|--------------------|------|
| `@Api`           | `@Tag`             | æè¿° Controller æ¨¡å— |

**ç¤ºä¾‹ï¼š**
```java
@Tag(name = "01. ç”¨æˆ·ç®¡ç†", description = "æä¾›ç”¨æˆ·å¢åˆ æ”¹æŸ¥æ¥å£")
@RestController
@RequestMapping("/users")
public class UserController { ... }
```

> ğŸ’¡ å»ºè®®åœ¨ `name` ä¸­åŠ åºå·ï¼ˆå¦‚ `"01. ç”¨æˆ·ç®¡ç†"`ï¼‰ï¼ŒKnife4j ä¼šè‡ªåŠ¨æŒ‰æ­¤æ’åºã€‚

---

### ğŸ”¹ æ–¹æ³•çº§åˆ«æ³¨è§£
| æ—§æ³¨è§£ | æ–°æ³¨è§£ | è¯´æ˜ |
|-------|--------|------|
| `@ApiOperation` | `@Operation` | æè¿°æ¥å£åŠŸèƒ½ |
| `@ApiImplicitParam` / `@ApiImplicitParams` | `@Parameter` | æè¿°å•ä¸ªæˆ–å¤šä¸ªå‚æ•° |
| `@ApiResponses` + `@ApiResponse` | `@ApiResponse`ï¼ˆé…åˆ `@Operation`ï¼‰ | æè¿°å“åº”çŠ¶æ€ç  |

**ç¤ºä¾‹ï¼š**

```java
@Operation(summary = "è·å–ç”¨æˆ·è¯¦æƒ…", description = "æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯")
@ApiResponse(responseCode = "200", description = "æŸ¥è¯¢æˆåŠŸ")
@ApiResponse(responseCode = "404", description = "ç”¨æˆ·ä¸å­˜åœ¨")
@GetMapping("/{id}")
public User getUserById(
    @Parameter(description = "ç”¨æˆ·ID", required = true, example = "1001")
    @PathVariable Long id) {
    return userService.findById(id);
}
```

---

### ğŸ”¹ å®ä½“ç±»/å­—æ®µæ³¨è§£
| æ—§æ³¨è§£ | æ–°æ³¨è§£ | è¯´æ˜ |
|-------|--------|------|
| `@ApiModelProperty` | `@Schema` | æè¿° POJO å­—æ®µæˆ–ç±» |

**ç¤ºä¾‹ï¼š**
```java
@Schema(description = "ç”¨æˆ·ä¿¡æ¯å®ä½“")
public class User {
    @Schema(description = "ç”¨æˆ·ID", example = "1001", accessMode = Schema.AccessMode.READ_ONLY)
    private Long id;

    @Schema(description = "ç”¨æˆ·å", requiredMode = RequiredMode.REQUIRED, example = "å¼ ä¸‰")
    private String name;
}
```

> âš ï¸ æ³¨æ„ï¼š`required = true` å·²æ”¹ä¸º `requiredMode = RequiredMode.REQUIRED`

---

## ğŸ†• Knife4j ç‰¹æœ‰å¢å¼ºæ³¨è§£ï¼ˆä»å…¼å®¹ Swagger 2 å’Œ OpenAPI 3ï¼‰

è¿™äº›æ³¨è§£æ˜¯ Knife4j è‡ªå·±æ‰©å±•çš„ï¼Œç”¨äºå¢å¼ºæ–‡æ¡£å±•ç¤ºæ•ˆæœï¼š

| æ³¨è§£ | ä½œç”¨ | é€‚ç”¨ç‰ˆæœ¬ |
|------|------|--------|
| `@ApiOperationSupport(order = 10)` | æ§åˆ¶æ¥å£åœ¨æ–‡æ¡£ä¸­çš„æ’åºé¡ºåº | Swagger 2 & OpenAPI 3 |
| `@DynamicParameters` | åŠ¨æ€å‚æ•°ï¼ˆè¾ƒå°‘ç”¨ï¼‰ | Swagger 2 |
| `@Ignore` | å¿½ç•¥æŸä¸ªæ¥å£ï¼ˆæ›¿ä»£ `@Hidden`ï¼‰ | Swagger 2 |

> ğŸ”” æ³¨æ„ï¼š`@ApiOperationSupport` åœ¨ OpenAPI 3 ä¸­ä¾ç„¶å¯ç”¨ï¼Œä½†éœ€ç¡®ä¿å¼•å…¥çš„æ˜¯ Knife4j ç›¸å…³ starterã€‚

---

## ğŸ“Œ æ€»ç»“ï¼šå¦‚ä½•é€‰æ‹©æ³¨è§£ï¼Ÿ

| é¡¹ç›®æŠ€æœ¯æ ˆ | æ¨èæ³¨è§£ä½“ç³» | ä¾èµ–ç¤ºä¾‹ |
|-----------|-------------|--------|
| Spring Boot â‰¤ 2.5 + Swagger 2 | ä½¿ç”¨ `@Api`, `@ApiOperation`, `@ApiModelProperty` | `knife4j-spring-boot-starter` |
| Spring Boot â‰¥ 2.6 æˆ– Spring Boot 3 + OpenAPI 3.0 | ä½¿ç”¨ `@Tag`, `@Operation`, `@Schema`, `@Parameter` | `knife4j-openapi3-jakarta-spring-boot-starter` |

---

# Mavenæ„å»ºæ’ä»¶ä½¿ç”¨æ¡ˆä¾‹è¯¦è§£

```xml
    <!-- ******************************************************** -->
    <!-- Mavenæ„å»ºé…ç½®éƒ¨åˆ†  -->
    <!--æ­¤éƒ¨åˆ†å®šä¹‰äº†é¡¹ç›®çš„æ„å»ºè¿‡ç¨‹ï¼ŒåŒ…æ‹¬æœ€ç»ˆè¾“å‡ºåç§°ã€æ’ä»¶é…ç½®å’Œèµ„æºå¤„ç†è§„åˆ™-->
    <!-- ******************************************************** -->
    <build>
        <!--
          æœ€ç»ˆç”Ÿæˆæ–‡ä»¶çš„å‘½åè§„åˆ™
          ${project.artifactId}ï¼šé¡¹ç›®æ ‡è¯†ç¬¦ï¼Œå¦‚"my-app"
          ${project.version}ï¼šé¡¹ç›®ç‰ˆæœ¬å·ï¼Œå¦‚"1.0.0"
          ç¤ºä¾‹ï¼šmy-app-1.0.0.jar
        -->
        <finalName>${project.artifactId}-${project.version}</finalName>

        <!-- Mavenæ’ä»¶é…ç½®åŒº -->
        <plugins>
            <!--
              Spring Boot Mavenæ’ä»¶
              ä½œç”¨ï¼šå°†é¡¹ç›®æ‰“åŒ…ä¸ºå¯æ‰§è¡Œçš„Spring Bootåº”ç”¨ï¼ˆfat jarï¼‰
              æ–‡æ¡£ï¼šhttps://docs.spring.io/spring-boot/docs/current/maven-plugin/reference/html/
            -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <!--
                      æ’é™¤ä¾èµ–é¡¹é…ç½®
                      æŒ‡å®šåœ¨æ‰“åŒ…å¯æ‰§è¡Œjaræ—¶éœ€è¦æ’é™¤çš„ä¾èµ–é¡¹
                      Lombokæ˜¯ç¼–è¯‘æ—¶ä¾èµ–ï¼Œè¿è¡Œæ—¶ä¸éœ€è¦ï¼Œå› æ­¤å¯ä»¥æ’é™¤ä»¥å‡å°‘jaråŒ…å¤§å°
                    -->
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                        <exclude>
                            <groupId>org.mapstruct</groupId>
                            <artifactId>mapstruct-processor</artifactId>
                        </exclude>
                    </excludes>
                    <!--
                      æŒ‡å®šSpring Bootåº”ç”¨çš„ä¸»å¯åŠ¨ç±»
                      è¯¥ç±»å¿…é¡»åŒ…å«mainæ–¹æ³•ï¼Œæ˜¯åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹
                    -->
                    <mainClass>cn.net.yunlou.bole.BoleApplication</mainClass>
                    <!--
                      è®¾ç½®ä¸ºtrueä¼šç”Ÿæˆå¯æ‰§è¡Œçš„jar/waræ–‡ä»¶
                      åœ¨Linux/Unixç³»ç»Ÿä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ ./app.jar æ–¹å¼è¿è¡Œ
                    -->
                    <executable>true</executable>

                    <!-- ä¼˜åŒ–ï¼šæ·»åŠ JVMå¯åŠ¨å‚æ•° -->
                    <jvmArguments>
                        -Xmx512m
                        -Xms256m
                        -XX:+UseG1GC
                        -XX:+HeapDumpOnOutOfMemoryError
                        -XX:HeapDumpPath=./heapdump.hprof
                    </jvmArguments>

                </configuration>
                <executions>
                    <!--
                      æ‰§è¡Œç›®æ ‡é…ç½®
                      repackageç›®æ ‡ï¼šé‡æ–°æ‰“åŒ…ç”Ÿæˆçš„jarï¼Œä½¿å…¶æˆä¸ºå¯æ‰§è¡Œçš„Spring Boot jar
                    -->
                    <execution>
                        <goals>
                            <goal>repackage</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>

            <!--
              Dockeræ„å»ºæ’ä»¶ï¼ˆSpotifyç‰ˆï¼‰
              ä½œç”¨ï¼šä½¿ç”¨Dockerfileæ„å»ºDockeré•œåƒå¹¶æ¨é€åˆ°ä»“åº“
              æ³¨æ„ï¼šæ­¤æ’ä»¶å·²ç”±Spring Bootå®˜æ–¹Dockeræ’ä»¶å–ä»£ï¼Œä½†ä»å¯ä½¿ç”¨
            -->
            <plugin>
                <groupId>com.spotify</groupId>
                <artifactId>dockerfile-maven-plugin</artifactId>
                <version>1.4.13</version>
                <configuration>
                    <!--
                      Dockeré•œåƒä»“åº“å’Œåç§°
                      ${docker.image.prefix}ï¼šé€šå¸¸åœ¨propertiesä¸­å®šä¹‰ï¼Œå¦‚"myregistry"
                      ç¤ºä¾‹ï¼šmyregistry/my-app:1.0.0
                    -->
                    <repository>${docker.image.prefix}/${project.artifactId}</repository>
                    <!-- Dockeré•œåƒæ ‡ç­¾ï¼Œä½¿ç”¨é¡¹ç›®ç‰ˆæœ¬å· -->
                    <tag>${project.version}</tag>
                    <!--
                      æ„å»ºå‚æ•°ï¼Œä¼ é€’ç»™Dockerfile
                      JAR_FILEï¼šæŒ‡å®šè¦æ‰“åŒ…åˆ°é•œåƒä¸­çš„jaræ–‡ä»¶è·¯å¾„
                    -->
                    <buildArgs>
                        <JAR_FILE>target/${project.build.finalName}.jar</JAR_FILE>
                    </buildArgs>
                </configuration>
            </plugin>



            <!--
              Mavenç¼–è¯‘æ’ä»¶
              ä½œç”¨ï¼šç¼–è¯‘é¡¹ç›®æºä»£ç ï¼Œé…ç½®Javaç‰ˆæœ¬å’Œç¼–è¯‘å‚æ•°
              æ–‡æ¡£ï¼šhttps://maven.apache.org/plugins/maven-compiler-plugin/
            -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>${maven-compiler-plugin.version}</version>
                <configuration>
                    <!-- æºä»£ç å…¼å®¹ç‰ˆæœ¬ -->
                    <source>${java.version}</source>
                    <!-- ç›®æ ‡å­—èŠ‚ç ç‰ˆæœ¬ -->
                    <target>${java.version}</target>
                    <!-- æºä»£ç æ–‡ä»¶ç¼–ç  -->
                    <encoding>${project.build.sourceEncoding}</encoding>
                    <!--
                      è®¾ç½®ä¸ºtrueï¼Œä¿ç•™æ–¹æ³•å‚æ•°åä¿¡æ¯ï¼ˆç”¨äºåå°„è·å–å‚æ•°åï¼‰
                      å¯¹Spring MVCç­‰æ¡†æ¶å¾ˆæœ‰ç”¨
                    -->
                    <parameters>true</parameters>
                    <!--
                      å¯ç”¨å¤–éƒ¨è¿›ç¨‹ç¼–è¯‘
                      ä¼˜ç‚¹ï¼šé¿å…å†…å­˜æ³„æ¼ï¼Œå¯ä»¥è®¾ç½®ç‹¬ç«‹å†…å­˜å‚æ•°
                    -->
                    <fork>true</fork>
                    <!-- ç¼–è¯‘è¿›ç¨‹çš„åˆå§‹å†…å­˜å¤§å° -->
                    <meminitial>512m</meminitial>
                    <!-- ç¼–è¯‘è¿›ç¨‹çš„æœ€å¤§å†…å­˜å¤§å° -->
                    <maxmem>2048m</maxmem>
                    <!--
                      æ³¨è§£å¤„ç†å™¨è·¯å¾„é…ç½®
                      æŒ‡å®šç¼–è¯‘æ—¶éœ€è¦ä½¿ç”¨çš„æ³¨è§£å¤„ç†å™¨
                    -->
                    <annotationProcessorPaths>
                        <!-- Lombokæ³¨è§£å¤„ç†å™¨ï¼Œç”¨äºç”Ÿæˆgetter/setterç­‰æ–¹æ³• -->
                        <path>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                            <version>${lombok.version}</version>
                        </path>
                        <!-- MapStructæ³¨è§£å¤„ç†å™¨ï¼Œç”¨äºç”Ÿæˆå¯¹è±¡æ˜ å°„ä»£ç  -->
                        <path>
                            <groupId>org.mapstruct</groupId>
                            <artifactId>mapstruct-processor</artifactId>
                            <version>${mapstruct.version}</version>
                        </path>
                    </annotationProcessorPaths>
                </configuration>
            </plugin>

            <!--
              èµ„æºå¤„ç†æ’ä»¶
              ä½œç”¨ï¼šå¤„ç†é¡¹ç›®èµ„æºæ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶ã€å±æ€§æ–‡ä»¶ç­‰
              æ–‡æ¡£ï¼šhttps://maven.apache.org/plugins/maven-resources-plugin/
            -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-resources-plugin</artifactId>
                <version>${maven-resources-plugin.version}</version>
                <configuration>
                    <!-- èµ„æºæ–‡ä»¶ç¼–ç  -->
                    <encoding>${project.build.sourceEncoding}</encoding>
                </configuration>
            </plugin>

            <!--
              ä»£ç æ ¼å¼åŒ–æ’ä»¶ï¼ˆSpotlessï¼‰
              ä½œç”¨ï¼šåœ¨æ„å»ºè¿‡ç¨‹ä¸­è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç ï¼Œä¿æŒä»£ç é£æ ¼ä¸€è‡´
              æ–‡æ¡£ï¼šhttps://github.com/diffplug/spotless/tree/main/plugin-maven
            -->
            <plugin>
                <groupId>com.diffplug.spotless</groupId>
                <artifactId>spotless-maven-plugin</artifactId>
                <version>${spotless-maven-plugin.version}</version>
                <configuration>
                    <!-- Javaä»£ç æ ¼å¼åŒ–é…ç½® -->
                    <java>
                        <!-- ä½¿ç”¨Google Java Formatè¿›è¡Œä»£ç æ ¼å¼åŒ– -->
                        <googleJavaFormat>
                            <version>1.17.0</version>
                            <!-- ä»£ç é£æ ¼ï¼šAOSPï¼ˆAndroidå¼€æºé¡¹ç›®é£æ ¼ï¼‰ -->
                            <style>AOSP</style>
                        </googleJavaFormat>
                        <!-- ç§»é™¤æœªä½¿ç”¨çš„importè¯­å¥ -->
                        <removeUnusedImports/>
                        <!-- ä¿®å‰ªè¡Œå°¾ç©ºæ ¼ -->
                        <trimTrailingWhitespace/>
                        <!-- æ–‡ä»¶ä»¥æ¢è¡Œç¬¦ç»“æŸ -->
                        <endWithNewline/>
                        <!--
                          æŒ‡å®šéœ€è¦æ ¼å¼åŒ–çš„æ–‡ä»¶èŒƒå›´
                          **/*.javaï¼šåŒ¹é…æ‰€æœ‰å­ç›®å½•ä¸‹çš„Javaæ–‡ä»¶
                        -->
                        <includes>
                            <include>src/main/java/**/*.java</include>
                            <include>src/test/java/**/*.java</include>
                        </includes>
                    </java>
                </configuration>
                <executions>
                    <!--
                      æ‰§è¡Œé…ç½®ï¼šåœ¨compileé˜¶æ®µæ‰§è¡Œspotlessçš„checkç›®æ ‡
                      checkç›®æ ‡ï¼šæ£€æŸ¥ä»£ç æ ¼å¼æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œä¸ç¬¦åˆåˆ™æ„å»ºå¤±è´¥
                    -->
                    <execution>
                        <goals>
                            <goal>check</goal>
                        </goals>
                        <phase>compile</phase>
                    </execution>
                </executions>
            </plugin>

            <!--
              Mavenæ‰§è¡Œæ’ä»¶
              ä½œç”¨ï¼šåœ¨Mavenæ„å»ºè¿‡ç¨‹ä¸­æ‰§è¡ŒJavaç±»
              æ–‡æ¡£ï¼šhttps://www.mojohaus.org/exec-maven-plugin/
            -->
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>exec-maven-plugin</artifactId>
                <version>${exec-maven-plugin.version}</version>
                <configuration>
                    <!--
                      æŒ‡å®šè¦æ‰§è¡Œçš„Javaä¸»ç±»
                      è¿™é‡Œé…ç½®çš„æ˜¯ä¸€ä¸ªä»£ç ç”Ÿæˆå™¨ï¼Œç”¨äºç”ŸæˆåŸºç¡€ä»£ç 
                    -->
                    <mainClass>cn.net.yunlou.bole.generator.CodeGenerator</mainClass>
                </configuration>
            </plugin>
        </plugins>

        <!--
          èµ„æºæ–‡ä»¶å¤„ç†é…ç½®
          å®šä¹‰äº†èµ„æºæ–‡ä»¶çš„å¤åˆ¶å’Œè¿‡æ»¤è§„åˆ™
        -->
        <resources>
            <!--
              ç¬¬ä¸€ç»„èµ„æºï¼šéœ€è¦å˜é‡æ›¿æ¢çš„èµ„æºæ–‡ä»¶
              filtering=trueï¼šå¯ç”¨Mavenå±æ€§è¿‡æ»¤ï¼Œå°†${property}æ›¿æ¢ä¸ºå®é™…å€¼
            -->
            <resource>
                <!-- èµ„æºæ–‡ä»¶æ‰€åœ¨ç›®å½• -->
                <directory>src/main/resources</directory>
                <!-- å¯ç”¨å±æ€§è¿‡æ»¤ -->
                <filtering>true</filtering>
                <!--
                  åŒ…å«çš„æ–‡ä»¶ç±»å‹ï¼šéœ€è¦è¿›è¡Œå˜é‡æ›¿æ¢çš„é…ç½®æ–‡ä»¶
                  é€šå¸¸åŒ…å«éœ€è¦æ³¨å…¥Mavenå±æ€§çš„æ–‡ä»¶
                -->
                <includes>
                    <include>**/*.properties</include>
                    <include>**/*.yml</include>
                    <include>**/*.yaml</include>
                    <include>**/*.xml</include>
                </includes>
            </resource>

            <!--
              ç¬¬äºŒç»„èµ„æºï¼šä¸éœ€è¦å˜é‡æ›¿æ¢çš„é™æ€èµ„æºæ–‡ä»¶
              filtering=falseï¼šç¦ç”¨å±æ€§è¿‡æ»¤ï¼ŒåŸæ ·å¤åˆ¶
            -->
            <resource>
                <directory>src/main/resources</directory>
                <!-- ç¦ç”¨å±æ€§è¿‡æ»¤ -->
                <filtering>false</filtering>
                <!--
                  æ’é™¤çš„æ–‡ä»¶ç±»å‹ï¼šä¸Šé¢å·²ç»å¤„ç†è¿‡çš„é…ç½®æ–‡ä»¶
                  å…¶ä»–æ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡ã€é™æ€HTMLç­‰ï¼‰å°†åŸæ ·å¤åˆ¶
                -->
                <excludes>
                    <exclude>**/*.properties</exclude>
                    <exclude>**/*.yml</exclude>
                    <exclude>**/*.yaml</exclude>
                    <exclude>**/*.xml</exclude>
                </excludes>
            </resource>
        </resources>
    </build>

```



### 1. **Spring Bootåº”ç”¨æ‰“åŒ…å’Œè¿è¡Œ**

```bash
# 1. æ¸…ç†å¹¶æ‰“åŒ…é¡¹ç›®
# ä¼šæ‰§è¡Œcleanã€compileã€testã€packageç­‰é˜¶æ®µ
mvn clean package

# 2. è·³è¿‡æµ‹è¯•æ‰“åŒ…
mvn clean package -DskipTests

# 3. è¿è¡ŒSpring Bootåº”ç”¨
# æ–¹å¼ä¸€ï¼šä½¿ç”¨spring-bootæ’ä»¶è¿è¡Œ
mvn spring-boot:run

# æ–¹å¼äºŒï¼šè¿è¡Œæ‰“åŒ…åçš„jar
java -jar target/bole-system-1.0.0-SNAPSHOT.jar

# 4. ç”Ÿäº§ç¯å¢ƒè¿è¡Œï¼ˆè®¾ç½®æ¿€æ´»çš„profileï¼‰
mvn spring-boot:run -Dspring-boot.run.profiles=prod

# 5. æŸ¥çœ‹Spring Bootåº”ç”¨ä¿¡æ¯
mvn spring-boot:help
```

### 2. **Dockeré•œåƒæ„å»ºå’Œæ¨é€**

```bash
# 1. æ„å»ºDockeré•œåƒï¼ˆéœ€è¦å…ˆæ‰“åŒ…ï¼‰
mvn clean package dockerfile:build

# 2. æ„å»ºå¹¶æ¨é€é•œåƒåˆ°ä»“åº“
mvn dockerfile:build dockerfile:push

# 3. æŒ‡å®šé•œåƒæ ‡ç­¾æ„å»º
mvn dockerfile:build -Ddockerfile.tag=v1.2.3

# 4. æ¸…ç†æœ¬åœ°Dockeré•œåƒ
mvn dockerfile:remove

# æ³¨æ„ï¼šéœ€è¦å…ˆå®‰è£…Dockerå¹¶ç¡®ä¿DockeræœåŠ¡è¿è¡Œ
```

### 3. **ä»£ç ç¼–è¯‘å’Œæ ¼å¼åŒ–**

```bash
# 1. ç¼–è¯‘é¡¹ç›®
mvn compile

# 2. æ£€æŸ¥ä»£ç æ ¼å¼ï¼ˆspotlessæ’ä»¶ï¼‰
mvn spotless:check

# 3. è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç 
mvn spotless:apply

# 4. åªæ ¼å¼åŒ–ç‰¹å®šæ–‡ä»¶
mvn spotless:apply -DspotlessFiles=src/main/java/com/example/UserService.java

# 5. æŸ¥çœ‹ç¼–è¯‘è¯¦æƒ…
mvn compile -X
```

### 4. **ä»£ç ç”Ÿæˆå™¨ä½¿ç”¨**

```bash
# 1. æ‰§è¡Œä»£ç ç”Ÿæˆå™¨
# éœ€è¦å…ˆç¼–å†™CodeGeneratorç±»
mvn exec:java

# 2. ä¼ é€’å‚æ•°ç»™ä»£ç ç”Ÿæˆå™¨
mvn exec:java -Dexec.args="--table user_info"

# 3. æŒ‡å®šä¸åŒçš„ä¸»ç±»æ‰§è¡Œ
mvn exec:java -Dexec.mainClass="cn.net.yunlou.bole.generator.EntityGenerator"

# 4. åœ¨æŒ‡å®šé˜¶æ®µè‡ªåŠ¨æ‰§è¡Œä»£ç ç”Ÿæˆ
# åœ¨pom.xmlä¸­é…ç½®executionåˆ°generate-sourcesé˜¶æ®µ
```

### 5. **èµ„æºå¤„ç†å’Œé…ç½®æ–‡ä»¶**

```bash
# 1. å¤„ç†èµ„æºæ–‡ä»¶ï¼ˆå˜é‡æ›¿æ¢ï¼‰
mvn resources:resources

# 2. æŸ¥çœ‹èµ„æºå¤„ç†è¯¦æƒ…
mvn resources:resources -X

# 3. å¤åˆ¶èµ„æºæ–‡ä»¶åˆ°æŒ‡å®šç›®å½•
mvn resources:copy-resources

# 4. æµ‹è¯•é…ç½®æ–‡ä»¶å˜é‡æ›¿æ¢
# åœ¨application.ymlä¸­ä½¿ç”¨${project.version}
# æ‰“åŒ…åä¼šæ›¿æ¢ä¸ºå®é™…ç‰ˆæœ¬å·
```

### 6. **å®Œæ•´æ„å»ºæµç¨‹æ¡ˆä¾‹**

```bash
# æ¡ˆä¾‹ï¼šå®Œæ•´çš„CI/CDæ„å»ºæµç¨‹è„šæœ¬
#!/bin/bash

# 1. è®¾ç½®ç¯å¢ƒå˜é‡
export JAVA_HOME=/usr/lib/jvm/java-8-openjdk
export MAVEN_OPTS="-Xmx2048m -XX:MaxPermSize=512m"

# 2. æ¸…ç†å·¥ä½œç©ºé—´
mvn clean

# 3. ä»£ç è´¨é‡æ£€æŸ¥
echo "=== ä»£ç æ ¼å¼åŒ–æ£€æŸ¥ ==="
mvn spotless:check
if [ $? -ne 0 ]; then
    echo "ä»£ç æ ¼å¼æ£€æŸ¥å¤±è´¥ï¼Œæ­£åœ¨è‡ªåŠ¨æ ¼å¼åŒ–..."
    mvn spotless:apply
    git add .
    git commit -m "style: auto format code"
fi

# 4. è¿è¡Œæµ‹è¯•
echo "=== è¿è¡Œå•å…ƒæµ‹è¯• ==="
mvn test -DskipITs

# 5. æ‰“åŒ…åº”ç”¨
echo "=== æ‰“åŒ…åº”ç”¨ ==="
mvn package -DskipTests

# 6. é›†æˆæµ‹è¯•
echo "=== è¿è¡Œé›†æˆæµ‹è¯• ==="
mvn verify -Dit.test=*IT

# 7. æ„å»ºDockeré•œåƒ
echo "=== æ„å»ºDockeré•œåƒ ==="
mvn dockerfile:build -Ddockerfile.tag=${BUILD_NUMBER}

# 8. æ¨é€é•œåƒåˆ°ä»“åº“
echo "=== æ¨é€Dockeré•œåƒ ==="
mvn dockerfile:push -Ddockerfile.tag=${BUILD_NUMBER}

# 9. ç”Ÿæˆæ„å»ºæŠ¥å‘Š
echo "=== ç”Ÿæˆæ„å»ºæŠ¥å‘Š ==="
mvn site:site
```

### 7. **å¤šç¯å¢ƒæ„å»ºé…ç½®**

```xml
<!-- åœ¨pom.xmlä¸­æ·»åŠ profilesé…ç½® -->
<profiles>
    <profile>
        <id>dev</id>
        <properties>
            <spring.profiles.active>dev</spring.profiles.active>
            <docker.image.prefix>dev-registry</docker.image.prefix>
        </properties>
        <activation>
            <activeByDefault>true</activeByDefault>
        </activation>
    </profile>
    
    <profile>
        <id>test</id>
        <properties>
            <spring.profiles.active>test</spring.profiles.active>
            <docker.image.prefix>test-registry</docker.image.prefix>
        </properties>
    </profile>
    
    <profile>
        <id>prod</id>
        <properties>
            <spring.profiles.active>prod</spring.profiles.active>
            <docker.image.prefix>prod-registry</docker.image.prefix>
        </properties>
    </profile>
</profiles>
```

ä½¿ç”¨ä¸åŒprofileæ„å»ºï¼š
```bash
# å¼€å‘ç¯å¢ƒæ„å»ºï¼ˆé»˜è®¤ï¼‰
mvn clean package

# æµ‹è¯•ç¯å¢ƒæ„å»º
mvn clean package -Ptest

# ç”Ÿäº§ç¯å¢ƒæ„å»º
mvn clean package -Pprod -DskipTests
```

### 8. **å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ**

#### é—®é¢˜1ï¼šLombokç¼–è¯‘é”™è¯¯
```bash
# è§£å†³æ–¹æ¡ˆï¼šç¡®ä¿æ³¨è§£å¤„ç†å™¨é…ç½®æ­£ç¡®
mvn clean compile

# å¦‚æœä»æœ‰é—®é¢˜ï¼Œå°è¯•ï¼š
mvn clean install -U
```

#### é—®é¢˜2ï¼šå†…å­˜ä¸è¶³å¯¼è‡´ç¼–è¯‘å¤±è´¥
```xml
<!-- åœ¨pom.xmlä¸­è°ƒæ•´å†…å­˜è®¾ç½® -->
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <configuration>
        <fork>true</fork>
        <meminitial>1024m</meminitial>
        <maxmem>4096m</maxmem>
        <compilerArgs>
            <arg>-J-XX:MaxPermSize=512m</arg>
        </compilerArgs>
    </configuration>
</plugin>
```

#### é—®é¢˜3ï¼šDockeræ„å»ºæƒé™é—®é¢˜
```bash
# è§£å†³æ–¹æ¡ˆï¼šå°†ç”¨æˆ·åŠ å…¥dockerç»„
sudo usermod -aG docker $USER

# æˆ–è€…ä½¿ç”¨rootæƒé™è¿è¡Œ
sudo mvn dockerfile:build
```

### 9. **è¿›é˜¶ä½¿ç”¨æŠ€å·§**

#### å¹¶è¡Œæ„å»ºåŠ é€Ÿ
```bash
# ä½¿ç”¨å¤šä¸ªçº¿ç¨‹å¹¶è¡Œæ„å»º
mvn clean package -T 4

# æ¯ä¸ªCPUæ ¸å¿ƒä¸€ä¸ªçº¿ç¨‹
mvn clean package -T 1C
```

#### æ„å»ºæ—¶é—´åˆ†æ
```bash
# ç”Ÿæˆæ„å»ºæ—¶é—´æŠ¥å‘Š
mvn clean package -Dmaven.build.timestamp.enabled=true

# ä½¿ç”¨æ„å»ºåˆ†ææ’ä»¶
mvn org.apache.maven.plugins:maven-timeline-plugin:timeline
```

#### ç¦»çº¿æ„å»º
```bash
# åœ¨æ— æ³•è®¿é—®ç½‘ç»œçš„ç¯å¢ƒä¸­ä½¿ç”¨
# é¦–å…ˆåœ¨æœ‰ç½‘ç»œçš„ç¯å¢ƒä¸‹è½½ä¾èµ–
mvn dependency:go-offline

# ç„¶ååœ¨ç¦»çº¿ç¯å¢ƒæ„å»º
mvn clean package -o
```

### 10. **Git Hooké›†æˆç¤ºä¾‹**

åœ¨ `.git/hooks/pre-commit` ä¸­æ·»åŠ ï¼š
```bash
#!/bin/bash
echo "Running pre-commit checks..."

# è¿è¡Œä»£ç æ ¼å¼åŒ–æ£€æŸ¥
mvn spotless:check

if [ $? -ne 0 ]; then
    echo "Code formatting issues found. Please run: mvn spotless:apply"
    exit 1
fi

# è¿è¡Œç¼–è¯‘æ£€æŸ¥
mvn compile -DskipTests

if [ $? -ne 0 ]; then
    echo "Compilation failed. Please fix compilation errors before committing."
    exit 1
fi

echo "Pre-commit checks passed!"
```

## ä¸‰ã€æœ€ä½³å®è·µå»ºè®®

1. **ç‰ˆæœ¬ç®¡ç†**ï¼š
    - æ‰€æœ‰æ’ä»¶ç‰ˆæœ¬åº”åœ¨propertiesä¸­ç»Ÿä¸€ç®¡ç†
    - ä½¿ç”¨å…·ä½“çš„ç‰ˆæœ¬å·ï¼Œé¿å…ä½¿ç”¨LATEST

2. **æ„å»ºä¼˜åŒ–**ï¼š
    - å¤§å‹é¡¹ç›®ä½¿ç”¨å¹¶è¡Œæ„å»ºï¼ˆ-Tå‚æ•°ï¼‰
    - åˆç†é…ç½®JVMå†…å­˜å‚æ•°
    - ä½¿ç”¨Maven Wrapperç¡®ä¿æ„å»ºç¯å¢ƒä¸€è‡´

3. **Dockeræ„å»º**ï¼š
    - ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºå‡å°é•œåƒå¤§å°
    - è®¾ç½®åˆé€‚çš„.dockerignoreæ–‡ä»¶
    - å®šæœŸæ¸…ç†æ—§é•œåƒ

4. **ä»£ç è´¨é‡**ï¼š
    - å°†spotless:checké›†æˆåˆ°CI/CDæµç¨‹
    - ä½¿ç”¨SonarQubeç­‰å·¥å…·è¿›è¡Œä»£ç åˆ†æ
    - è®¾ç½®åˆç†çš„.gitignoreæ–‡ä»¶

5. **èµ„æºç®¡ç†**ï¼š
    - é…ç½®æ–‡ä»¶åˆ†ç¦»ï¼šdev/test/prodç¯å¢ƒç‹¬ç«‹é…ç½®
    - æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–é…ç½®ä¸­å¿ƒ
    - é™æ€èµ„æºä½¿ç”¨CDNæˆ–å¯¹è±¡å­˜å‚¨

é€šè¿‡ä»¥ä¸Šé…ç½®å’Œä½¿ç”¨æ¡ˆä¾‹ï¼Œå¯ä»¥å»ºç«‹ä¸€ä¸ªå®Œæ•´çš„ã€å¯ç»´æŠ¤çš„Spring Booté¡¹ç›®æ„å»ºä½“ç³»ï¼Œæ”¯æŒä»å¼€å‘ã€æµ‹è¯•åˆ°éƒ¨ç½²çš„å…¨æµç¨‹è‡ªåŠ¨åŒ–ã€‚